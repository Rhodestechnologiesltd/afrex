<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="asc_purchase_order_template">
        <t t-call="web.basic_layout">
            <t t-set="o" t-value="o.with_context(lang=lang)"/>
            <!-- <link href="https://fonts.googleapis.com/css?family=Times New Roman" rel="stylesheet"/> -->
            <style>
                table, th, td {
                border:0px solid white;
                }
                <!-- body {
                    font-family: 'Times New Roman';
                    font-weight: normal;
                } -->
            </style>
            <div style="font-size: 12px; margin-top: 0%; margin-bottom: 0%; margin-left: 5%; margin-right: 5%; padding-bottom: 0px;">
                <div class="row mb8">
                    <div class="col-6">
                        <img t-if="o.company_id.logo" t-att-src="image_data_uri(o.company_id.logo)"
                             style="margin-top: 5px; margin-bottom: 20px; max-height: 90px;" alt="Logo"/>
                        <table style="font-size: 12px; width:90%; margin-bottom:15px; border: 1px solid;">
                            <style>
                                tr, th, td {
                                border: 0px solid white;
                                }
                                td {
                                padding-left: 5px;
                                }
                            </style>
                            <tr>
                                <td>
                                    <b>
                                        <span style="display: inline-block; border-bottom: 1pt solid black;">Vendor:
                                        </span>
                                    </b>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>
                                        <span t-field="o.partner_id.name"/>
                                    </strong>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <span t-field="o.partner_id.address_text"/>
                                </td>
                            </tr>
                            <t t-if="o.company_id.x_display_partner_child and o.partner_id.child_ids">
                                <t t-set="partner_children"
                                   t-value="o.partner_id.child_ids.sorted(key=lambda l: (l.create_date))"/>
                                <t t-foreach="partner_children" t-as="partner_child">
                                    <tr t-if="partner_child.name">
                                        <td>
                                            Contact Person:
                                            <span t-field="partner_child.name"/>
                                        </td>
                                    </tr>
                                    <tr t-if="partner_child.email">
                                        <td>
                                            Email:
                                            <span t-field="partner_child.email"/>
                                        </td>
                                    </tr>
                                    <tr t-if="partner_child.phone">
                                        <td>
                                            Phone:
                                            <span t-field="partner_child.phone"/>
                                        </td>
                                    </tr>
                                </t>
                            </t>
                        </table>
                        <table style="font-size: 12px; width:90%; margin-bottom:15px; border: 1px solid;">
                            <style>
                                tr, th, td {
                                border: 0px solid white;
                                }
                                td {
                                padding-left: 5px;
                                }
                            </style>
                            <tr>
                                <td>
                                    <b>
                                        <span style="display: inline-block; border-bottom: 1pt solid black;">Buyer:
                                        </span>
                                    </b>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>
                                        <span t-field="o.company_id.name"/>
                                    </strong>
                                </td>
                            </tr>
                            <!-- <tr>
                                <td>
                                    <span t-field="o.company_id.partner_id.address_text"/>
                                </td>
                            </tr> -->
                        </table>
                    </div>
                    <div class="col-6 text-end mb-2">
                        <table class="table-lg mb-1" style="width: 85%; margin-left: 15%; border: 1px solid;">
                            <tr>
                                <th valign="middle" class="h5"
                                    style="text-align: center; padding-top: 5px; padding-bottom: 5px;">
                                    PURCHASE ORDER
                                </th>
                            </tr>
                        </table>
                        <table class="table table-sm table-borderless"
                               style="width: 85%; margin-left: 15%; border: 0px solid white;">
                            <tr>
                                <th style="text-align: start; padding: 0;">
                                    <strong>
                                        <span t-field="o.company_id.name"/>
                                    </strong>
                                </th>
                            </tr>
                            <tr>
                                <td style="text-align: start; padding: 0;">
                                    <span>Suite 420, 4th Floor, Barkly Wharf Building</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align: start; padding: 0;">
                                    <span>Caudan Waterfront, Port Louis</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align: start; padding: 0;">
                                    <span>Mauritius</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align: start; padding: 0;">
                                    <span>Email: DL-AfrexSupplier@supergrp.com</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align: start; padding: 0;">
                                    <span>Tel: +230 271 1176</span>
                                    <span style="padding-left: 10px;">Fax: +230 211 8959</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="text-align: start; padding: 0;">
                                    <span>Website: www.supergrp.com</span>
                                </td>
                            </tr>
                        </table>
                        <table class="table table-sm table-borderless mb-1 mx-0"
                               style="font-size: 12px; width: 100%; border: 0px solid white;">
                            <tr t-if="o.name">
                                <th style="width:65%; text-align: right; padding-top:0px; padding-right:5px;">Afrex
                                    Purchase Order Number:
                                </th>
                                <th style="width:35%; text-align: left;">
                                    <span t-field="o.name"/>
                                </th>
                            </tr>
                            <tr t-if="o.date_approve">
                                <th style="width:65%; text-align: right; padding-top:0px; padding-right:5px;">Date:</th>
                                <th style="width:35%; text-align: left;">
                                    <span t-esc="o.date_approve.strftime('%d-%B-%Y')"/>
                                </th>
                            </tr>
                            <tr t-if="o.partner_ref">
                                <th style="width:65%; text-align: right; padding-top:0px; padding-right:5px;">Vendor
                                    Reference Document Number:
                                </th>
                                <th style="width:35%; text-align: left;">
                                    <span t-field="o.partner_ref"/>
                                </th>
                            </tr>
                            <tr t-if="o.supplier_reference_doc_date">
                                <th style="width:65%; text-align: right; padding-top:0px; padding-right:5px;">Vendor
                                    Reference Document Date:
                                </th>
                                <th style="width:35%; text-align: left;">
                                    <span t-esc="o.supplier_reference_doc_date.strftime('%d-%B-%Y')"/>
                                </th>
                            </tr>
                            <tr t-if="o.lead_id">
                                <th style="width:65%; text-align: right; padding-top:0px; padding-right:5px;">Our
                                    Reference:
                                </th>
                                <th style="width:35%; text-align: left;">
                                    <span t-field="o.lead_id.name"/>
                                </th>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <table class="table table-sm o_main_table mt-4" name="invoice_line_table"
                   style="font-size: 12px; border:1px solid black; width:90%; margin-left:5%; margin-right:5%; page-break-inside: avoid; box-sizing: border-box; border-collapse: collapse;">
                <thead>
                    <tr>
                        <th valign="middle" name="th_description" class="text-center"
                            style="width:40%; border:1px solid black; vertical-align: middle;">
                            <span>Description</span>
                        </th>
                        <th valign="middle" name="th_packaging" class="text-center"
                            style="width:15%; border:1px solid black; vertical-align: middle;">
                            <span>Packaging</span>
                        </th>
                        <th name="th_qty" class="text-center"
                            style="width:15%; border:1px solid black; padding: 0; margin: 0;">
                            <div style="display: table; width: 100%; border-collapse: collapse;">
                                <div style="display: table-row;">
                                    <div style="display: table-cell; border-bottom: 1px solid black; text-align: center; padding: 2px 0; width: 100%;">
                                        Qty
                                    </div>
                                </div>
                                <div style="display: table-row;">
                                    <div style="display: table-cell; text-align: center; padding: 2px 0; width: 100%;">
                                        MT
                                    </div>
                                </div>
                            </div>
                        </th>
                        <th name="th_price" class="text-center"
                            style="width:15%; border:1px solid black; padding: 0; margin: 0;">
                            <div style="display: table; width: 100%; border-collapse: collapse;">
                                <div style="display: table-row;">
                                    <div t-if="o.incoterm_selection == 'dap'"
                                         style="display: table-cell; border-bottom: 1px solid black; text-align: center; padding: 2px 0; width: 100%;">
                                        DAP / MT
                                    </div>
                                    <div t-else=""
                                         style="display: table-cell; border-bottom: 1px solid black; text-align: center; padding: 2px 0; width: 100%;">
                                        Price / MT
                                    </div>
                                </div>
                                <div style="display: table-row;">
                                    <div style="display: table-cell; text-align: center; padding: 2px 0; width: 100%;">
                                        <span t-field="o.currency_id.name" t-options="{'widget': 'text'}"/>
                                    </div>
                                </div>
                            </div>
                        </th>
                        <th name="th_total" class="text-center"
                            style="width:15%; border:1px solid black; padding: 0; margin: 0;">
                            <div style="display: table; width: 100%; border-collapse: collapse;">
                                <div style="display: table-row;">
                                    <div style="display: table-cell; border-bottom: 1px solid black; text-align: center; padding: 2px 0; width: 100%;">
                                        Total
                                    </div>
                                </div>
                                <div style="display: table-row;">
                                    <div style="display: table-cell; text-align: center; padding: 2px 0; width: 100%;">
                                        <span t-field="o.currency_id.name" t-options="{'widget': 'text'}"/>
                                    </div>
                                </div>
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody class="invoice_tbody">
                    <t t-set="lines"
                       t-value="o.order_line.sorted(key=lambda l: (-l.sequence, l.date_order, l.order_id.id, -l.id), reverse=True)"/>
                    <t t-set="tax_totals" t-value="o.tax_totals"/>
                    <t t-foreach="lines" t-as="line">
                        <tr>
                            <td style="border: 1pt solid black; text-align: center;">
                                <span t-field="line.name" t-options="{'widget': 'text'}"/>
                            </td>
                            <td style="border: 1pt solid black; text-align: center;">
                                <span t-field="line.packaging_id.name" t-options="{'widget': 'text'}"/>
                            </td>
                            <td class="text-end" style="border: 1pt solid black; text-align: center;">
                                <span class="text-nowrap" t-field="line.product_uom_qty"
                                      t-options="{'widget': 'float', 'precision': 3}"/>
                            </td>
                            <td class="o_price_total" style="border: 1pt solid black;">
                                <span t-field="line.currency_id.name"/>
                                <span class="text-nowrap float-end" t-field="line.price_unit"
                                      t-options="{'widget': 'float', 'precision': 2}"/>
                            </td>
                            <td class="o_price_total" style="border: 1pt solid black;">
                                <span t-field="line.currency_id.name"/>
                                <span class="text-nowrap float-end" t-field="line.price_total"
                                      t-options="{'widget': 'float', 'precision': 2}"/>
                            </td>
                        </tr>
                    </t>
                    <tr t-if="o.incoterm_selection not in ['dap','fca']">
                        <td colspan="5" style="border-bottom: 1px solid black; height: 5px;"/>
                    </tr>
                    <t t-if="o.incoterm_selection == 'cif'">
                        <tr>
                            <td colspan="1" style="border:1px solid black; vertical-align: middle;"/>
                            <th rowspan="3" valign="middle" class="text-center"
                                style="border:1px solid black; vertical-align: middle;">
                                <span>CIF Price Breakdown</span>
                            </th>
                            <th colspan="2" style="border:1px solid black; padding: 0; margin: 0;">
                                <div style="display: table; width: 100%; border-collapse: collapse;">
                                    <div style="display: table-row;">
                                        <div style="display: table-cell; border-bottom: 1px solid black; padding: 2px 0; width: 100%;">
                                            <span class="text-start">FOB</span>
                                        </div>
                                    </div>
                                    <div style="display: table-row;">
                                        <div style="display: table-cell; border-bottom: 1px solid black; padding: 2px 0; width: 100%;">
                                            <span class="text-start">Insurance</span>
                                        </div>
                                    </div>
                                    <div style="display: table-row;">
                                        <div style="display: table-cell; padding: 2px 0; width: 100%;">
                                            <span>Freight</span>
                                        </div>
                                    </div>
                                </div>
                            </th>
                            <th colspan="1" valign="middle" style="border:1px solid black; padding: 0; margin: 0;">
                                <div style="display: table; width: 100%; border-collapse: collapse;">
                                    <div style="display: table-row;">
                                        <div style="text-align: left; display: table-cell; border-bottom: 1px solid black; padding: 2px 0; width: 100%;">
                                            <span t-if="o.fob_amount and o.show_breakdown" style="padding-left: 10px;"
                                                  t-field="o.currency_id.name"/>
                                            <span t-if="o.fob_amount and o.show_breakdown" class="text-nowrap float-end"
                                                  style="padding-right: 10px;" t-field="o.fob_amount"
                                                  t-options="{'widget': 'float', 'precision': 2}"/>
                                            <span t-else="" class="text-start" style="padding-left: 10px;">To be
                                                confirmed
                                            </span>
                                        </div>
                                    </div>
                                    <div style="display: table-row;">
                                        <div style="text-align: left; display: table-cell; border-bottom: 1px solid black; padding: 2px 0; width: 100%;">
                                            <span t-if="o.insurance_amount and o.show_breakdown"
                                                  style="padding-left: 10px;" t-field="o.currency_id.name"/>
                                            <span t-if="o.insurance_amount and o.show_breakdown" class="float-end"
                                                  style="padding-right: 10px;" t-field="o.insurance_amount"
                                                  t-options="{'widget': 'float', 'precision': 2}"/>
                                            <span t-else="" class="text-start" style="padding-left: 10px;">To be
                                                confirmed
                                            </span>
                                        </div>
                                    </div>
                                    <div style="display: table-row;">
                                        <div style="text-align: left; display: table-cell; padding: 2px 0; width: 100%;">
                                            <span t-if="o.freight_amount and o.show_breakdown"
                                                  style="padding-left: 10px;" t-field="o.currency_id.name"/>
                                            <span t-if="o.freight_amount and o.show_breakdown" class="float-end"
                                                  style="padding-right: 10px;" t-field="o.freight_amount"
                                                  t-options="{'widget': 'float', 'precision': 2}"/>
                                            <span t-else="" class="text-start" style="padding-left: 10px;">To be
                                                confirmed
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </th>
                        </tr>
                    </t>
                    <t t-if="o.incoterm_selection == 'cfr'">
                        <tr>
                            <td colspan="1" style="border:1px solid black; vertical-align: middle;"/>
                            <th rowspan="2" valign="middle" class="text-center"
                                style="border:1px solid black; vertical-align: middle;">
                                <span>CFR Price Breakdown</span>
                            </th>
                            <th colspan="2" style="border:1px solid black; padding: 0; margin: 0;">
                                <div style="display: table; width: 100%; border-collapse: collapse;">
                                    <div style="display: table-row;">
                                        <div style="display: table-cell; border-bottom: 1px solid black; padding: 2px 0; width: 100%;">
                                            <span class="text-start">FOB</span>
                                        </div>
                                    </div>
                                    <div style="display: table-row;">
                                        <div style="display: table-cell; padding: 2px 0; width: 100%;">
                                            <span>Freight</span>
                                        </div>
                                    </div>
                                </div>
                            </th>
                            <th colspan="1" valign="middle" style="border:1px solid black; padding: 0; margin: 0;">
                                <div style="display: table; width: 100%; border-collapse: collapse;">
                                    <div style="display: table-row;">
                                        <div style="text-align: left; display: table-cell; border-bottom: 1px solid black; padding: 2px 0; width: 100%;">
                                            <span t-if="o.fob_amount and o.show_breakdown" style="padding-left: 10px;"
                                                  t-field="o.currency_id.name"/>
                                            <span t-if="o.fob_amount and o.show_breakdown" class="text-nowrap float-end"
                                                  style="padding-right: 10px;" t-field="o.fob_amount"
                                                  t-options="{'widget': 'float', 'precision': 2}"/>
                                            <span t-else="" class="text-start" style="padding-left: 10px;">To be
                                                confirmed
                                            </span>
                                        </div>
                                    </div>
                                    <div style="display: table-row;">
                                        <div style="text-align: left; display: table-cell; padding: 2px 0; width: 100%;">
                                            <span t-if="o.freight_amount and o.show_breakdown"
                                                  style="padding-left: 10px;" t-field="o.currency_id.name"/>
                                            <span t-if="o.freight_amount and o.show_breakdown" class="float-end"
                                                  style="padding-right: 10px;" t-field="o.freight_amount"
                                                  t-options="{'widget': 'float', 'precision': 2}"/>
                                            <span t-else="" class="text-start" style="padding-left: 10px;">To be
                                                confirmed
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </th>
                        </tr>
                    </t>
                    <t t-if="o.incoterm_selection == 'fob'">
                        <tr>
                            <td colspan="1" style="border:1px solid black; vertical-align: middle;"/>
                            <th t-if="o.show_breakdown" rowspan="2" valign="middle" class="text-center"
                                style="border:1px solid black; vertical-align: middle;">
                                <span>FOB Price Breakdown</span>
                            </th>
                            <th t-else="" valign="middle" class="text-center"
                                style="border:1px solid black; vertical-align: middle;">
                                <span>FOB Price Breakdown</span>
                            </th>
                            <th colspan="2" style="border:1px solid black; padding: 0; margin: 0;">
                                <div style="display: table; width: 100%; border-collapse: collapse;">
                                    <div style="display: table-row;">
                                        <div style="display: table-cell; padding: 2px 0; width: 100%;">
                                            <span>FOB</span>
                                        </div>
                                    </div>
                                </div>
                            </th>
                            <th colspan="1" valign="middle" style="border:1px solid black; padding: 0; margin: 0;">
                                <div style="display: table; width: 100%; border-collapse: collapse;">
                                    <div style="display: table-row;">
                                        <div style="text-align: left; display: table-cell; padding: 2px 0; width: 100%;">
                                            <span t-if="o.fob_amount and o.show_breakdown" style="padding-left: 10px;"
                                                  t-field="o.currency_id.name"/>
                                            <span t-if="o.fob_amount and o.show_breakdown" class="float-end"
                                                  style="padding-right: 10px;" t-field="o.fob_amount"
                                                  t-options="{'widget': 'float', 'precision': 2}"/>
                                            <span t-else="" class="text-start" style="padding-left: 10px;">To be
                                                confirmed
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </th>
                        </tr>
                    </t>
                    <t t-if="o.incoterm_selection == 'dap'">
                        <tr>
                            <td colspan="1" style="border:1px solid black; vertical-align: middle;"/>
                            <th rowspan="2" valign="middle" class="text-center"
                                style="border:1px solid black; vertical-align: middle;">
                                <span>DAP Price Breakdown</span>
                            </th>
                            <th t-if="not o.is_internal" colspan="2"
                                style="border:1px solid black; padding: 0; margin: 0;">
                                <div style="display: table; width: 100%; border-collapse: collapse;">
                                    <div style="display: table-row;">
                                        <div style="display: table-cell; border-bottom: 1px solid black; padding: 2px 0; width: 100%;">
                                            <span class="text-start">FCA</span>
                                        </div>
                                    </div>
                                    <div style="display: table-row;">
                                        <div style="display: table-cell; padding: 2px 0; width: 100%;">
                                            <span>Transportation and Clearance</span>
                                        </div>
                                    </div>
                                </div>
                            </th>
                            <th t-else="" colspan="2" style="border:1px solid black; padding: 0; margin: 0;">
                                <div style="display: table; width: 100%; border-collapse: collapse;">
                                    <div style="display: table-row;">
                                        <div style="display: table-cell; border-bottom: 1px solid black; padding: 2px 0; width: 100%;">
                                            <span class="text-start">FCA</span>
                                        </div>
                                    </div>
                                    <div style="display: table-row;">
                                        <div style="display: table-cell; border-bottom: 1px solid black; padding: 2px 0; width: 100%;">
                                            <span>Transportation and Clearance</span>
                                        </div>
                                    </div>
                                    <div style="display: table-row;">
                                        <div style="display: table-cell; border-bottom: 1px solid black; padding: 2px 0; width: 100%;">
                                            <span>Interest</span>
                                        </div>
                                    </div>
                                    <div style="display: table-row;">
                                        <div style="display: table-cell; padding: 2px 0; width: 100%;">
                                            <span>Procurement and Documentation</span>
                                        </div>
                                    </div>
                                </div>
                            </th>
                            <td colspan="1" valign="middle" style="border:1px solid black; padding: 0; margin: 0;">
                                <div t-if="not o.is_internal"
                                     style="display: table; width: 100%; border-collapse: collapse;">
                                    <div style="display: table-row;">
                                        <div style="text-align: left; display: table-cell; border-bottom: 1px solid black; padding: 2px 0; width: 100%;">
                                            <span t-if="o.fca_amount" style="padding-left: 5px;"
                                                  t-field="o.currency_id.name"/>
                                            <span t-if="o.fca_amount" class="text-nowrap float-end"
                                                  style="padding-right: 5px;" t-field="o.fca_amount"
                                                  t-options="{'widget': 'float', 'precision': 2}"/>
                                            <span t-else="" class="text-start" style="padding-left: 10px;">To be
                                                confirmed
                                            </span>
                                        </div>
                                    </div>
                                    <div style="display: table-row;">
                                        <div style="text-align: left; display: table-cell; padding: 2px 0; width: 100%;">
                                            <span t-if="o.road_transportation_amount" style="padding-left: 5px;"
                                                  t-field="o.currency_id.name"/>
                                            <span t-if="o.road_transportation_amount" class="text-nowrap float-end"
                                                  style="padding-right: 5px;" t-field="o.road_transportation_amount"
                                                  t-options="{'widget': 'float', 'precision': 2}"/>
                                            <span t-else="" class="text-start" style="padding-left: 10px;">To be
                                                confirmed
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div t-else="" style="display: table; width: 100%; border-collapse: collapse;">
                                    <div style="display: table-row;">
                                        <div style="text-align: left; display: table-cell; border-bottom: 1px solid black; padding: 2px 0; width: 100%;">
                                            <span t-if="o.fca_amount" style="padding-left: 5px;"
                                                  t-field="o.currency_id.name"/>
                                            <span t-if="o.fca_amount" class="text-nowrap float-end"
                                                  style="padding-right: 5px;" t-field="o.fca_amount"
                                                  t-options="{'widget': 'float', 'precision': 2}"/>
                                            <span t-else="" class="text-start" style="padding-left: 10px;">To be
                                                confirmed
                                            </span>
                                        </div>
                                    </div>
                                    <div style="display: table-row;">
                                        <div style="text-align: left; display: table-cell; border-bottom: 1px solid black; padding: 2px 0; width: 100%;">
                                            <span t-if="o.road_transportation_amount" style="padding-left: 5px;"
                                                  t-field="o.currency_id.name"/>
                                            <span t-if="o.road_transportation_amount" class="text-nowrap float-end"
                                                  style="padding-right: 5px;" t-field="o.road_transportation_amount"
                                                  t-options="{'widget': 'float', 'precision': 2}"/>
                                            <span t-else="" class="text-start" style="padding-left: 10px;">To be
                                                confirmed
                                            </span>
                                        </div>
                                    </div>
                                    <div style="display: table-row;">
                                        <div style="text-align: left; display: table-cell; border-bottom: 1px solid black; padding: 2px 0; width: 100%;">
                                            <span t-if="o.interest_amount" style="padding-left: 5px;"
                                                  t-field="o.currency_id.name"/>
                                            <span t-if="o.interest_amount" class="text-nowrap float-end"
                                                  style="padding-right: 5px;" t-field="o.interest_amount"
                                                  t-options="{'widget': 'float', 'precision': 2}"/>
                                            <span t-else="" class="text-start" style="padding-left: 10px;">To be
                                                confirmed
                                            </span>
                                        </div>
                                    </div>
                                    <div style="display: table-row;">
                                        <div style="text-align: left; display: table-cell; padding: 2px 0; width: 100%;">
                                            <span t-if="o.procurement_documentation_amount" style="padding-left: 5px;"
                                                  t-field="o.currency_id.name"/>
                                            <span t-if="o.procurement_documentation_amount"
                                                  class="text-nowrap float-end" style="padding-right: 5px;"
                                                  t-field="o.procurement_documentation_amount"
                                                  t-options="{'widget': 'float', 'precision': 2}"/>
                                            <span t-else="" class="text-start" style="padding-left: 10px;">To be
                                                confirmed
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </t>
                </tbody>
            </table>
            <table class="table table-sm table-borderless"
                   style="width:90%; margin-left: 5%; margin-right: 5%; font-size: 12px; border: 0px solid white;">
                <tr valign="middle" style="padding-bottom: 0;">
                    <td valign="middle" style="text-align:left; padding-bottom: 0;">
                        <span>Amount in Words (<span t-field="o.currency_id.name"/>):
                        </span>
                    </td>
                </tr>
                <tr style="padding-top: 0;">
                    <th class="text-nowrap" style="width:75%; text-align: left;">
                        <strong>
                            <span t-field="o.number_to_words" t-options="{'widget': 'text'}"></span>
                        </strong>
                        <!-- <strong><span>FOURTEEN THOUSAND EIGHT HUNDRED THIRTY SIX DOLLARS AND FIFTY CENTS</span></strong> -->
                    </th>
                    <th class="text-nowrap" style="width:10%; text-align: right; word-spacing: 4px;">Total Amount Due
                    </th>
                    <th class="text-nowrap text-start"
                        style="width:15%; border-top: 1pt solid black; border-bottom: 3pt double black;">
                        <span t-field="o.currency_id.name"/>
                        <strong>
                            <span class="float-end" t-field="o.amount_total"
                                  t-options="{'widget': 'float', 'precision': 2}"/>
                        </strong>
                    </th>
                </tr>
            </table>
            <table class="table-borderless"
                   style="width:90%; margin-left: 5%; margin-right: 2%; margin-bottom:0px; padding-bottom: 0px; border: 0px solid white; font-size: 12px;">
                <tr>
                    <th class="text-start" style="width:25%; padding-left: 5px;">
                        <span style="padding-right:5px; padding-left; 5px;">Incoterms (<span
                                t-field="o.incoterm_implementation_year"/>) :
                        </span>
                    </th>
                    <td t-if="o.incoterm_selection not in ['fob','fca','exw']" class="text-start">
                        <span t-field="o.incoterm_id.code"/>
                        <span t-field="o.discharge_port_id.name"/>
                    </td>
                    <td t-if="o.incoterm_selection in ['fob','fca','exw']" class="text-start">
                        <span t-field="o.incoterm_id.code"/>
                        <span t-field="o.loading_port_id.name"/>
                    </td>
                </tr>
                <tr>
                    <th class="text-start" style="width:25%; padding-left: 5px;">
                        <span style="padding-right:5px; padding-left; 5px;">Payment Terms :</span>
                    </th>
                    <td class="text-start">
                        <span t-field="o.payment_term_id.name"/>
                    </td>
                </tr>
                <tr>
                    <th class="text-start" style="width:25%; padding-left: 5px;">
                        <span t-if="o.supplier_delivery_method == 'sea'" style="padding-right:5px; padding-left; 5px;">
                            Port of Loading :
                        </span>
                        <span t-if="o.supplier_delivery_method == 'road'" style="padding-right:5px; padding-left; 5px;">
                            Place of Loading :
                        </span>
                    </th>
                    <td class="text-start">
                        <span t-field="o.loading_port_id.name"/>
                    </td>
                </tr>
                <tr>
                    <th class="text-start" style="width:25%; padding-left: 5px;">
                        <span t-if="o.supplier_delivery_method == 'sea'" style="padding-right:5px; padding-left; 5px;">
                            Port of Discharge :
                        </span>
                        <span t-if="o.supplier_delivery_method == 'road'" style="padding-right:5px; padding-left; 5px;">
                            Place of Delivery :
                        </span>
                    </th>
                    <td class="text-start">
                        <span t-field="o.discharge_port_id.name"/>
                    </td>
                </tr>
                <tr>
                    <th class="text-start" style="width:25%; padding-left: 5px;">
                        <span t-if="o.supplier_delivery_method == 'sea'" style="padding-right:5px; padding-left; 5px;">
                            Shipment Window :
                        </span>
                        <span t-if="o.supplier_delivery_method == 'road'" style="padding-right:5px; padding-left; 5px;">
                            Shipment Window :
                        </span>
                    </th>
                    <td class="text-start">
                        <span t-field="o.shipment_window_start"/>
                        -
                        <span t-field="o.shipment_window_end"/>
                    </td>
                </tr>
                <tr t-if="o.supplier_delivery_method == 'sea'">
                    <th class="text-start" style="width:25%; padding-left: 5px;">
                        <span style="padding-right:5px; padding-left; 5px;">Trans Shipment :</span>
                    </th>
                    <td class="text-start">
                        <t t-if="o.trans_shipment == 'allowed'">
                            <span>Allowed</span>
                        </t>
                        <t t-else="">
                            <span>Not allowed</span>
                        </t>
                    </td>
                </tr>
                <tr t-if="o.supplier_delivery_method == 'sea'">
                    <th class="text-start" style="width:25%; padding-left: 5px;">
                        <span style="padding-right:5px; padding-left; 5px;">Partial Shipment :</span>
                    </th>
                    <td class="text-start">
                        <t t-if="o.partial_shipment == 'allowed'">
                            <span>Allowed</span>
                        </t>
                        <t t-else="">
                            <span>Not allowed</span>
                        </t>
                    </td>
                </tr>
                <t t-if="o.supplier_delivery_method == 'sea'">
                    <tr t-if="o.breakbulk_container == 'container' and o.container_count > 0">
                        <th class="text-start" style="width:25%; padding-left: 5px;">
                            <span style="padding-right:5px; padding-left; 5px;">Number of Containers :</span>
                        </th>
                        <td class="text-start">
                            <span t-field="o.container_count"/>
                            x
                            <span t-field="o.container_type_id.name"/>
                        </td>
                    </tr>
                </t>
                <tr>
                    <th class="text-start" style="width:25%; padding-left: 5px;">
                        <span style="padding-right:5px; padding-left; 5px;">Country of Origin :</span>
                    </th>
                    <td class="text-start">
                        <t t-if="o.origin_country_id">
                            <span t-field="o.origin_country_id.name"/>
                        </t>
                        <t t-else="">
                            <span>To be confirmed</span>
                        </t>
                    </td>
                </tr>
                <tr t-if="o.supplier_delivery_method == 'sea'">
                    <th class="text-start" style="width:25%; padding-left: 5px;">
                        <span style="padding-right:5px; padding-left; 5px;">Afrex Ltd Payment Cut-Off :</span>
                    </th>
                    <td class="text-start">
                        <span>Documents to be presented to Afrex Limited a minimum of two workdays before payment is
                            required.
                        </span>
                    </td>
                </tr>
                <tr t-if="o.supplier_delivery_method == 'sea'">
                    <th class="text-start" style="width:25%; padding-left: 5px;">
                        <span style="padding-right:5px; padding-left; 5px;">Documentary Requirements :</span>
                    </th>
                    <td class="text-start">
                        <span>Refer to our Shipping Instructions which will be a separate document</span>
                    </td>
                </tr>
                <tr t-if="o.supplier_delivery_method == 'road'">
                    <th class="text-start" style="width:25%; padding-left: 5px;">
                        <span style="padding-right:5px; padding-left; 5px;">Documentary Requirements :</span>
                    </th>
                    <td class="text-start">
                        <span>Refer to our Loading Instructions which will be a separate document</span>
                    </td>
                </tr>
                <tr>
                    <th class="text-start" style="width:25%; padding-left: 5px;">
                        <span style="padding-right:5px; padding-left; 5px;">Instructions to Seller :</span>
                    </th>
                    <td class="text-start">
                    </td>
                </tr>
                <tr t-if="o.supplier_delivery_method == 'sea'">
                    <td colspan="2" class="text-start" style="padding-left: 5px;">
                        <div>
                            <span style="display: block; margin-bottom: 3px;">1. All documents to be in English.</span>
                            <span style="display: block; margin-bottom: 3px;">2. In the event that a change is required
                                to this order, the order will be cancelled and considered null and void, and a new order
                                will be issued.
                            </span>
                            <span style="display: block; margin-bottom: 3px;">3. The product must have a minimum of 90%
                                shelf-life remaining at time of shipment (Shipped on Board date).
                            </span>
                            <span style="display: block; margin-bottom: 3px;">4. The product quality must be as per the
                                specifications / COA provided at the time of business enquiry; Any deviation in
                                parameters will lead to rejection of said lot at shipper's cost.
                            </span>
                            <span style="display: block; margin-bottom: 3px;">5. Shipment to be executed as per above
                                mentionned shipment window or within the time period indicated on supplier's sales
                                contract. Any further delay will give Afrex Ltd the right to either cancel the order or
                                to re-negotiate the deal.
                            </span>
                            <span style="display: block; margin-bottom: 3px;">6. Manufacturer Certificate of Analysis
                                for each batch of the total consignment to be supplied at least one week before shipment
                                date.
                            </span>
                            <span style="display: block; margin-bottom: 3px;">7. Packaging and label pictures to be
                                provided for our approval before stuffing for containerized cargo or before loading for
                                break bulk cargo.
                            </span>
                            <span style="display: block; margin-bottom: 3px;">8. Countersigned and stamped Afrex
                                purchase order and shipping instructions to be returned to Afrex Ltd within 2 working
                                days from receipt.
                            </span>
                        </div>
                    </td>
                </tr>
                <tr t-if="o.supplier_delivery_method == 'road'">
                    <td colspan="2" class="text-start" style="padding-left: 5px;">
                        <div>
                            <span style="display: block; margin-bottom: 3px;">1. All documents to be in English.</span>
                            <span style="display: block; margin-bottom: 3px;">2. In the event that a change is required
                                to this order, the order will be cancelled and considered null and void, and a new order
                                will be issued.
                            </span>
                            <span style="display: block; margin-bottom: 3px;">3. The product quality must be as per the
                                specifications / COA provided at the time of business enquiry; Any deviation in
                                parameters will lead to rejection of said lot at shipper's cost.
                            </span>
                            <span t-if="o.supplier_contract_date" style="display: block; margin-bottom: 3px;">4.
                                Shipment to be executed as per above mentionned shipment window or within the time
                                period indicated on supplier's commodity supply agreement dated<t
                                        t-esc="o.supplier_contract_date"/>. Any further delay will give Afrex Ltd the
                                right to either cancel the order or to re-negotiate the deal.
                            </span>
                            <span t-else="" style="display: block; margin-bottom: 3px;">4. Shipment to be executed as
                                per above mentionned shipment window or within the time period indicated on supplier's
                                sales contract. Any further delay will give Afrex Ltd the right to either cancel the
                                order or to re-negotiate the deal.
                            </span>
                            <span style="display: block; margin-bottom: 3px;">5. Manufacturer Certificate of Analysis
                                for each batch of the total consignment to be supplied for each shipment.
                            </span>
                            <span style="display: block; margin-bottom: 3px;">6. Countersigned and stamped Afrex
                                purchase order and shipping instructions to be returned to Afrex Ltd within 2 working
                                days from receipt.
                            </span>
                        </div>
                    </td>
                </tr>
            </table>
            <table class="table table-sm table-borderless mt-2"
                   style="width:90%; margin-left: 5%; margin-right: 2%; margin-bottom:0px; padding-bottom: 0px; border: 0px solid white; font-size: 12px;">
                <tr>
                    <td style="width: 70%;">
                        <span>Signed and Stamped by:</span>
                        <br/>
                        <b>
                            <span t-field="o.company_id.name"/>
                        </b>
                        <br/>
                        <img t-if="o.company_id.seal" t-att-src="image_data_uri(o.company_id.seal)"
                             style="margin-top: 5px; padding-left: 150px; max-height: 90px;" alt="Logo"/>
                        <br/>
                        <span t-if="o.date_approve">Date:</span>
                        <span t-if="o.date_approve" t-esc="o.date_approve.strftime('%d-%B-%Y')"/>
                    </td>
                    <td style="width: 30%;">
                        <span>Signed and Stamped by:</span>
                        <br/>
                        <b>
                            <span t-field="o.partner_id.name"/>
                        </b>
                    </td>
                </tr>
            </table>
        </t>
    </template>

    <template id="report_asc_purchase_order">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="afrex_supply_chain.asc_purchase_order_template" t-lang="o.partner_id.lang"/>
            </t>
        </t>
    </template>

</odoo>